import glob
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 20971.52it/s]
1it [00:00, 991.56it/s]
import torch
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 41120.63it/s]
1it [00:00, 2922.86it/s]
import os
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47127.01it/s]
1it [00:00, 3477.86it/s]
import sys
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47662.55it/s]
1it [00:00, 3609.56it/s]
from tqdm import tqdm
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49932.19it/s]
1it [00:00, 3524.63it/s]
from dalle_pytorch import VQGanVAE, DALLE, DiscreteVAE
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 37117.73it/s]
1it [00:00, 2385.84it/s]
from dalle_pytorch.tokenizer import tokenizer
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47127.01it/s]
1it [00:00, 3144.16it/s]
from einops import repeat
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48770.98it/s]
1it [00:00, 3214.03it/s]
from dalle_nc import DALLE, DiscreteVAE
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47662.55it/s]
1it [00:00, 3545.48it/s]
from torch.utils.data import DataLoader
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48770.98it/s]
1it [00:00, 2835.91it/s]
from torch.utils.data import Dataset
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 3435.14it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47662.55it/s]
1it [00:00, 4624.37it/s]
# model
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49932.19it/s]
1it [00:00, 3675.99it/s]
vae = DiscreteVAE(
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 3855.06it/s]
    image_size = 8,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 3554.49it/s]
    num_layers = 3,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49344.75it/s]
1it [00:00, 3509.88it/s]
    num_tokens = 8192,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 3539.50it/s]
    codebook_dim = 1024,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 45590.26it/s]
1it [00:00, 2989.53it/s]
    hidden_dim = 64,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 3560.53it/s]
    num_resnet_blocks = 1,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48210.39it/s]
1it [00:00, 3209.11it/s]
    temperature = 0.9
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3313.04it/s]
)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49344.75it/s]
1it [00:00, 4223.87it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 4877.10it/s]
dalle = DALLE(
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 4052.47it/s]
    dim = 1024,
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 4072.14it/s]
    vae = vae,                  # automatically infer (1) image sequence length and (2) number of image tokens
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 41527.76it/s]
1it [00:00, 1760.09it/s]
    num_text_tokens = 100000,    # vocab size for text
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 45590.26it/s]
1it [00:00, 2693.84it/s]
    text_seq_len = 256,         # text sequence length
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49344.75it/s]
1it [00:00, 3179.91it/s]
    depth = 12,                 # should aim to be 64
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 3059.30it/s]
    heads = 16,                 # attention heads
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47662.55it/s]
1it [00:00, 2864.96it/s]
    dim_head = 64,              # attention head dimension
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47662.55it/s]
1it [00:00, 2951.66it/s]
    attn_dropout = 0.1,         # attention dropout
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49932.19it/s]
1it [00:00, 3179.91it/s]
    ff_dropout = 0.1            # feedforward dropout
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48770.98it/s]
1it [00:00, 2235.77it/s]
)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55188.21it/s]
1it [00:00, 4359.98it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 57456.22it/s]
1it [00:00, 5475.59it/s]
dalle.eval()
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 51150.05it/s]
1it [00:00, 3695.42it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 5398.07it/s]
# real data for DALLE image generation
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3287.07it/s]
files = glob.glob(os.path.dirname(os.path.realpath(sys.argv[0])) + "/real_text.txt")
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47127.01it/s]
1it [00:00, 2264.74it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53773.13it/s]
1it [00:00, 4888.47it/s]
# create dataloader
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48770.98it/s]
1it [00:00, 3748.26it/s]
input_list = []
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 3618.90it/s]
with torch.no_grad():
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 3741.57it/s]
    count = 0
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 48210.39it/s]
1it [00:00, 3819.95it/s]
    for file in files:
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3840.94it/s]
        texts = open(file, 'r').read().split('\n')
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3002.37it/s]
        for text in texts:
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55188.21it/s]
1it [00:00, 4156.89it/s]
            print(text)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 3813.00it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 5090.17it/s]
            num_images = 1
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 3672.77it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 5454.23it/s]
            top_k = 0.9
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53773.13it/s]
1it [00:00, 4100.00it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 5419.00it/s]
            image_size = vae.image_size
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 4021.38it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 56679.78it/s]
1it [00:00, 5555.37it/s]
            texts = text.split('|')
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]

  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
2it [00:00, 4478.70it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 5071.71it/s]
            for j, text in tqdm(enumerate(texts)):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49932.19it/s]
1it [00:00, 3123.09it/s]
                text_tokens = tokenizer.tokenize([text], 256).to('cpu')
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 52428.80it/s]
1it [00:00, 3015.32it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 56679.78it/s]
1it [00:00, 5146.39it/s]
                text_tokens = repeat(text_tokens, '() n -> b n', b=num_images)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 51781.53it/s]
1it [00:00, 3398.95it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 56679.78it/s]
1it [00:00, 5405.03it/s]
                for text_chunk in tqdm(text_tokens):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49932.19it/s]
1it [00:00, 3501.09it/s]
                    d = {}
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 4040.76it/s]
                    d["text"] = text_chunk
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55188.21it/s]
1it [00:00, 3916.25it/s]
                    d["filter_thres"] = top_k
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3393.45it/s]
                    input_list.append(d)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 49344.75it/s]
1it [00:00, 3449.26it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 5343.06it/s]
class MyDataset(Dataset):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 3326.17it/s]
    def __init__(self):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 3584.88it/s]
        self.samples = input_list
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3688.92it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 43690.67it/s]
1it [00:00, 5197.40it/s]
    def __getitem__(self, idx):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 56679.78it/s]
1it [00:00, 3415.56it/s]
        return self.samples[idx], 1
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 3775.25it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55188.21it/s]
1it [00:00, 5584.96it/s]
    def __len__(self):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53773.13it/s]
1it [00:00, 4396.55it/s]
        return len(self.samples)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 50533.78it/s]
1it [00:00, 4152.78it/s]
dataset = MyDataset()
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53773.13it/s]
1it [00:00, 4279.90it/s]
dataloader = DataLoader(dataset)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 4185.93it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 56679.78it/s]
1it [00:00, 5562.74it/s]
# inference
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 54471.48it/s]
1it [00:00, 3644.05it/s]
with torch.no_grad():
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53773.13it/s]
1it [00:00, 4128.25it/s]
    for step, (inputs, labels) in enumerate(dataloader):
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 47127.01it/s]
1it [00:00, 3004.52it/s]
        print("running inference ...")
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 51781.53it/s]
1it [00:00, 3401.71it/s]
        output = dalle(**inputs)
0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 53092.46it/s]
1it [00:00, 3634.58it/s]

0it [00:00, ?it/s]
  0%|          | 0/1 [00:00<?, ?it/s][A100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<00:00, 55924.05it/s]
1it [00:00, 5447.15it/s]
running inference ...
Neural_Coder_Bench_IPS:  2.707
Neural_Coder_Bench_MSPI:  369.449
Neural_Coder_Bench_P50:  366.825
Neural_Coder_Bench_P90:  385.665
Neural_Coder_Bench_P99:  385.665
